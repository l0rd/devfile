---
version: 0.0.1
name: petclinic-dev-environment
projects:
  - name: petclinic
    source:
      type: git
      location: 'git@github.com:spring-projects/spring-petclinic.git'
tools:
  - name: mvn-stack
    type: dockerImage
    image: maven:3.5.4-jdk-8
    entryPoint: sleep infinity
    persistentVolumes:
      - name: maven-repo
        containerPath: /root/.m2
    services:
      - name: spring-boot
        port: 8080
    mountProjectsSources: true
  - name: mysql
    type: composeFile
    local: docker-compose.yml
  - name: theia-ide
    type: cheEditor
    id: eclipse/theia:0.0.3
  - name: jdt.ls
    type: chePlugin
    id: eclipse/theia-jdtls:0.0.3
actions:
  - name: build
    items:
      - tool: mvn-stack
        action:
          type: exec
          command: mvn package
          workdir: /projects/spring-petclinic 
  - name: run
    items:
      - tool: mysql
        action: 
          type: start
      - tool: mvn-stack
        action:
          type: exec
          command: mvn spring-boot:run
          workdir: /projects/spring-petclinic
