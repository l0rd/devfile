---
version: 0.0.1
name: petclinic-dev-environment
projects:
  - name: petclinic
    source:
      type: git
      location: 'git@github.com:spring-projects/spring-petclinic.git'
tools:
  - name: mvn-stack
    definition:
      dockerImage:
        image: maven:3.5.4-jdk-8
        entryPoint: sleep infinity
        persistentVolumes:
          - name: maven-repo
            containerPath: /root/.m2
        services:
          - name: spring-boot
            port: 8080
    mountProjectsSources: true
  - name: mysql
    definition:
      composeFile:
        local: docker-compose.yml
  - name: theia-ide
    definition:
      cheEditor:
        name: eclipse/theia:0.0.3
  - name: jdt.ls
    definition:
      chePlugin:
        name: eclipse/theia-jdtls:0.0.3
actions:
  - name: build
    toolsActions:
      - tool: mvn-stack
        action:
          exec:
            command: mvn package
            workdir: /projects/spring-petclinic 
  - name: run
    toolsActions:
      - tool: mysql
        action: start
      - tool: mvn-stack
        action:
          exec:
            command: mvn spring-boot:run
            workdir: /projects/spring-petclinic 
